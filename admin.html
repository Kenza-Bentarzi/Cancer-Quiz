<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <title>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠØ© ğŸ—ï¸</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@700&display=swap" rel="stylesheet">
    <style>
        /* Ø³Ø£Ø­ØªÙØ¸ Ø¨Ù†ÙØ³ Ø§Ù„Ù€ CSS Ø§Ù„Ø±Ø§Ø¦Ø¹ Ø§Ù„Ø®Ø§Øµ Ø¨ÙƒÙ Ù…Ø¹ Ø¥Ø¶Ø§ÙØ© Ø¨Ø¹Ø¶ Ø§Ù„Ø£Ø²Ø±Ø§Ø± */
        :root {
            --bg: #2d0031;
            --card: #4a0e4e;
            --accent-pink: #ffb6c1;
            --gold: #ffd700;
        }

        body {
            background: var(--bg);
            color: white;
            font-family: 'Cairo', sans-serif;
            text-align: center;
            padding: 20px;
            margin: 0;
        }

        .control-panel {
            background: var(--card);
            padding: 20px;
            border-radius: 15px;
            max-width: 800px;
            margin: 20px auto;
            border: 2px solid #5d1461;
        }

        .q-btn {
            background: #6b7280;
            color: white;
            border: none;
            padding: 10px 15px;
            margin: 5px;
            border-radius: 8px;
            cursor: pointer;
        }

        .q-btn.active {
            background: var(--accent-pink);
            color: var(--bg);
        }

        .timer-display {
            font-size: 2.5rem;
            color: var(--gold);
            margin: 10px 0;
        }

        .btn-action {
            background: #22c55e;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
            margin: 5px;
        }

        .player-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 85%;
            max-width: 550px;
            background: var(--card);
            padding: 15px;
            border-radius: 15px;
            margin: 10px auto;
            border-right: 8px solid var(--accent-pink);
        }

        .team-a {
            border-right-color: #3b82f6;
        }

        /* Ù„ÙˆÙ† Ø£Ø²Ø±Ù‚ Ù„Ù„ÙØ±ÙŠÙ‚ Ø£ */
        .team-b {
            border-right-color: #ef4444;
        }

        /* Ù„ÙˆÙ† Ø£Ø­Ù…Ø± Ù„Ù„ÙØ±ÙŠÙ‚ Ø¨ */
    </style>
</head>

<body>

    <h1>Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø³Ø§Ø¨Ù‚Ø© Ø§Ù„Ø­ÙŠØ© ğŸ—ï¸</h1>

    <div class="control-panel">
        <h3>Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ø§Ù„Ø£Ø³Ø¦Ù„Ø©</h3>
        <div id="questionButtons">
        </div>

        <div class="timer-display" id="timer">01:00</div>

        <button class="btn-action" onclick="startTimer()">Ø¨Ø¯Ø¡ Ø§Ù„ÙˆÙ‚Øª (Ø¯Ù‚ÙŠÙ‚Ø©) â±ï¸</button>
        <button class="btn-action" style="background:#3b82f6" onclick="showCorrectAnswer()">Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©
            âœ…</button>
    </div>

    <div id="leaderboard" class="container">
        <h3>Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ÙØ±Ù‚ Ø§Ù„Ø­ÙŠØ©</h3>
    </div>

    <script>
        const dbURL = "https://quiz-game-f3475-default-rtdb.firebaseio.com/";
        let currentTimer;

        // ØªÙˆÙ„ÙŠØ¯ 10 Ø£Ø²Ø±Ø§Ø± Ù„Ù„Ø£Ø³Ø¦Ù„Ø©
        const btnContainer = document.getElementById('questionButtons');
        for (let i = 1; i <= 10; i++) {
            btnContainer.innerHTML += `<button class="q-btn" id="q${i}" onclick="setQuestion(${i})">Ø³Ø¤Ø§Ù„ ${i}</button>`;
        }

        function setQuestion(num) {
            // ØªØ­Ø¯ÙŠØ« Ø±Ù‚Ù… Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠ ÙÙŠ Firebase
            fetch(dbURL + "gameState.json", {
                method: 'PATCH',
                body: JSON.stringify({
                    currentQuestion: num,
                    canAnswer: true,
                    showCorrect: false
                })
            });

            // ØªÙ…ÙŠÙŠØ² Ø§Ù„Ø²Ø± Ø§Ù„Ù…Ø®ØªØ§Ø±
            document.querySelectorAll('.q-btn').forEach(b => b.classList.remove('active'));
            document.getElementById('q' + num).classList.add('active');
            resetTimerDisplay();
        }

        function startTimer() {
            let timeLeft = 60;
            clearInterval(currentTimer);
            currentTimer = setInterval(() => {
                timeLeft--;
                document.getElementById('timer').innerText = `00:${timeLeft < 10 ? '0' + timeLeft : timeLeft}`;

                if (timeLeft <= 0) {
                    clearInterval(currentTimer);
                    lockAnswers();
                }
            }, 1000);
        }

        function lockAnswers() {
            fetch(dbURL + "gameState.json", { method: 'PATCH', body: JSON.stringify({ canAnswer: false }) });
            alert("Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ÙˆÙ‚Øª! ØªÙ… ØºÙ„Ù‚ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª.");
        }

        function showCorrectAnswer() {
            fetch(dbURL + "gameState.json", { method: 'PATCH', body: JSON.stringify({ showCorrect: true }) });
        }

        function updateLeaderboard() {
            fetch(dbURL + "results.json").then(r => r.json()).then(data => {
                let board = document.getElementById('leaderboard');
                if (!data) return;

                board.innerHTML = "";
                Object.values(data).forEach(p => {
                    board.innerHTML += `
                    <div class="player-row ${p.team === 'A' ? 'team-a' : 'team-b'}">
                        <div style="text-align:right">
                            <span><b>[ÙØ±ÙŠÙ‚ ${p.team}] ${p.name}</b></span>
                            <br><small>Ø§Ø®ØªØ§Ø±: ${p.lastAns || 'Ù„Ù… ÙŠØ¬Ø¨ Ø¨Ø¹Ø¯'}</small>
                        </div>
                        <div style="font-size:25px; color:var(--gold)">${p.score} Ù†</div>
                    </div>`;
                });
            });
        }

        function resetTimerDisplay() {
            clearInterval(currentTimer);
            document.getElementById('timer').innerText = "01:00";
        }

        setInterval(updateLeaderboard, 2000);
    </script>
</body>

</html>
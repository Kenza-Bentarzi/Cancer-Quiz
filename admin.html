<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <title>Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… ÙƒÙ†Ø²Ø© ğŸ—ï¸</title>
    <style>
        body {
            font-family: 'Cairo', sans-serif;
            background: #2c3e50;
            color: white;
            text-align: center;
            padding: 30px;
        }

        .box {
            background: #34495e;
            padding: 25px;
            border-radius: 20px;
            margin: 20px auto;
            max-width: 600px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }

        .btn {
            padding: 18px 35px;
            font-size: 22px;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            color: white;
            margin: 10px;
            font-weight: bold;
            transition: 0.3s;
        }

        .next {
            background: #27ae60;
            box-shadow: 0 5px 0 #219150;
        }

        .next:active {
            transform: translateY(5px);
            box-shadow: none;
        }

        .reset {
            background: #e74c3c;
            font-size: 16px;
            margin-top: 50px;
        }

        .player-row {
            background: white;
            color: #333;
            padding: 15px;
            margin: 10px 0;
            border-radius: 10px;
            display: flex;
            justify-content: space-between;
            font-size: 20px;
        }

        .score-badge {
            background: #e91e63;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
        }
    </style>
</head>

<body>
    <h1>Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„Ù…Ø³Ø§Ø¨Ù‚Ø© ğŸ—ï¸</h1>
    <div class="box">
        <h2 id="step-txt">Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ø¨Ø¯Ø¡</h2>
        <button class="btn next" onclick="next()">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„ØªØ§Ù„ÙŠ â¡ï¸</button>
    </div>

    <div class="box" id="leaderboard">
        <h3>Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ù…ØªØ³Ø§Ø¨Ù‚Ø§Øª (Ù…Ø¨Ø§Ø´Ø±):</h3>
        <div id="players-list"></div>
    </div>

    <button class="btn reset" onclick="reset()">ğŸ”„ Ø¨Ø¯Ø¡ Ù…Ø³Ø§Ø¨Ù‚Ø© Ø¬Ø¯ÙŠØ¯Ø© ØªÙ…Ø§Ù…Ø§Ù‹ (ØªØµÙÙŠØ±)</button>

    <script>
        const dbURL = "https://quiz-game-f3475-default-rtdb.firebaseio.com/";
        let currentStep = -1;

        async function reset() {
            if (confirm("Ù‡Ù„ Ø£Ù†ØªÙ Ù…ØªØ£ÙƒØ¯Ø©ØŸ Ø³ÙŠØªÙ… Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ØªØ³Ø§Ø¨Ù‚Ø§Øª ÙˆØ§Ù„Ø¨Ø¯Ø¡ Ù…Ù† Ø§Ù„ØµÙØ±.")) {
                await fetch(`${dbURL}.json`, { method: 'DELETE' });
                await fetch(`${dbURL}state.json`, { method: 'PUT', body: JSON.stringify({ step: -1, reset: true }) });
                location.reload();
            }
        }

        async function next() {
            currentStep++;
            await fetch(`${dbURL}state.json`, { method: 'PATCH', body: JSON.stringify({ step: currentStep, reset: false }) });
            document.getElementById('step-txt').innerText = "Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠ: " + (currentStep + 1);
        }

        setInterval(async () => {
            const res = await fetch(`${dbURL}players.json`);
            const data = await res.json();
            const list = document.getElementById('players-list');
            list.innerHTML = "";
            if (data) {
                Object.entries(data).forEach(([name, info]) => {
                    list.innerHTML += `<div class="player-row"><span>ğŸ‘©â€ğŸ’¼ ${name}</span><span class="score-badge">${info.score} Ù†Ù‚Ø·Ø©</span></div>`;
                });
            } else { list.innerHTML = "Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…ØªØ³Ø§Ø¨Ù‚Ø§Øª Ø­Ø§Ù„ÙŠØ§Ù‹"; }
        }, 2000);
    </script>
</body>

</html>